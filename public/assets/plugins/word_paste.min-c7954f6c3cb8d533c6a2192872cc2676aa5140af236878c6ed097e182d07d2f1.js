!function(r){"function"==typeof define&&define.amd?define(["jquery"],r):"object"==typeof module&&module.exports?module.exports=function(e,t){return t===undefined&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(e)),r(t)}:r(window.jQuery)}(function(S){S.extend(S.FE.DEFAULTS,{wordDeniedTags:[],wordDeniedAttrs:[],wordAllowedStyleProps:["font-family","font-size","background","color","width","text-align","vertical-align","background-color","padding","margin","height","margin-top","margin-left","margin-right","margin-bottom","text-decoration","font-weight","font-style","text-indent","border","border-.*"],wordPasteModal:!0,wordPasteKeepFormatting:!0}),S.FE.PLUGINS.wordPaste=function(A){function t(e){var t=A.opts.wordAllowedStyleProps;e||(A.opts.wordAllowedStyleProps=[]),0===i.indexOf("<colgroup>")&&(i="<table>"+i+"</table>"),i=function(l,t){0<=l.indexOf("<html")&&(l=l.replace(/[.\s\S\w\W<>]*(<html[^>]*>[.\s\S\w\W<>]*<\/html>)[.\s\S\w\W<>]*/i,"$1")),function(){for(var e=l.split("v:shape"),t=1;t<e.length;t++){var r=e[t],i=r.split(' id="')[1];if(i&&1<i.length){i=i.split('"')[0];var n=r.split(' o:spid="')[1];n&&1<n.length&&(n=n.split('"')[0],c[i]=n)}}}();var e=(new DOMParser).parseFromString(l,"text/html"),d=e.head,r=e.body,a=function(){var e={},t=d.getElementsByTagName("style");if(t.length){var r=t[0].innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi);if(r)for(var i=0;i<r.length;i++){var n=r[i],l=n.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),a=n.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");l=l.replace(/^[\s]|[\s]$/gm,""),a=a.replace(/^[\s]|[\s]$/gm,""),l=l.replace(/\n|\r|\n\r/g,""),a=a.replace(/\n|\r|\n\r/g,"");for(var o=l.split(", "),s=0;s<o.length;s++)e[o[s]]=a}}return e}();g(r,function(e){if(e.nodeType==Node.TEXT_NODE&&/\n|\u00a0|\r/.test(e.data)){if(!/\S| /.test(e.data))return e.data==S.FE.UNICODE_NBSP?(e.data="\u200b",!0):1==e.data.length&&10==e.data.charCodeAt(0)?(e.data=" ",!0):(y(e),!1);e.data=e.data.replace(/\n|\r/gi," ")}return!0}),g(r,function(e){return e.nodeType!=Node.ELEMENT_NODE||"V:IMAGEDATA"!=e.tagName&&"IMG"!=e.tagName||function(e,t){if(t){var r;if("IMG"==e.tagName){var i=e.getAttribute("src");if(!i||-1==i.indexOf("file://"))return;if(0===i.indexOf("file://")&&A.helpers.isURL(e.getAttribute("alt")))return e.setAttribute("src",e.getAttribute("alt"));r=c[e.getAttribute("v:shapes")]}else r=e.parentNode.getAttribute("o:spid");if(e.removeAttribute("height"),r){var n;p={},f(n=t,"i","\\shppict"),f(n,"s","\\shp{");var l=p[r.substring(7)];if(l){var a=function(){for(var e=l.image_hex.match(/[0-9a-f]{2}/gi),t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(parseInt(e[r],16)));var i=t.join("");return btoa(i)}(),o="data:"+l.image_type+";base64,"+a;"IMG"===e.tagName?(e.src=o,e.setAttribute("data-fr-image-pasted",!0)):S(e.parentNode).before('<img data-fr-image-pasted="true" src="'+o+'" style="'+e.parentNode.getAttribute("style")+'">').remove()}}}}(e,t),!0});for(var i=r.querySelectorAll("ul > ul, ul > ol, ol > ul, ol > ol"),n=i.length-1;0<=n;n--)i[n].previousElementSibling&&"LI"===i[n].previousElementSibling.tagName&&i[n].previousElementSibling.appendChild(i[n]);g(r,function(e){if(e.nodeType==Node.TEXT_NODE)return e.data=e.data.replace(/<br>(\n|\r)/gi,"<br>"),!1;if(e.nodeType!=Node.ELEMENT_NODE)return e.nodeType!=Node.COMMENT_NODE||(y(e),!1);if(C(e)){var t=e.parentNode,r=e.previousSibling,i=function h(e,t){var r,i=/[0-9a-zA-Z]./gi,n=!1,l=!1,a=!1,o=e.querySelector('span[style="mso-list:Ignore"]');o&&(n=n||i.test(o.textContent));var s=n?"ol":"ul",d=v(e),g="<"+s+"><li>"+b(e,t),f=e.nextElementSibling;null!=f&&(r=f.previousElementSibling);var u=e.parentNode;for(y(e),e=null;f;){if(!C(f)){if(f.outerHTML&&0<f.outerHTML.indexOf("mso-bookmark")&&0==(f.textContent||"").length){f=f.nextElementSibling;continue}break}var p=v(f);if(d<p)g+=h(f,t).outerHTML;else{if(p<d)break;f.firstElementChild&&f.firstElementChild.firstElementChild&&f.firstElementChild.firstElementChild.firstChild&&(i.lastIndex=0,l=i.test(f.firstElementChild.firstElementChild.firstChild.data||"")),r&&r.firstElementChild&&r.firstElementChild.firstElementChild&&r.firstElementChild.firstElementChild.firstChild&&(i.lastIndex=0,a=i.test(r.firstElementChild.firstElementChild.firstChild.data||"")),a===undefined||a===l?g+="</li><li>"+b(f,t):g+=h(f,t).outerHTML}if(d=p,f.previousElementSibling||f.nextElementSibling||f.parentNode){var c=f;f=f.nextElementSibling,y(c),c=null}else f=r?r.nextElementSibling:u.firstElementChild}g+="</li></"+s+">";var m=document.createElement("div");return m.innerHTML=g,m.firstElementChild}(e,a),n=null;return(n=r?r.nextSibling:t.firstChild)?t.insertBefore(i,n):t.appendChild(i),!1}return u(e,a)}),g(r,function(e){if(e.nodeType==Node.ELEMENT_NODE){var t=e.tagName;if(!e.innerHTML&&-1==["BR","IMG"].indexOf(t)){for(var r=e.parentNode;r&&(y(e),!(e=r).innerHTML);)r=e.parentNode;return!1}!function(e){var t=e.getAttribute("style");if(t){(t=N(t))&&";"!=t.slice(-1)&&(t+=";");var r=t.match(/(^|\S+?):.+?;{1,1}/gi);if(r){for(var i={},n=0;n<r.length;n++){var l=r[n].split(":");2==l.length&&("text-align"==l[0]&&"SPAN"==e.tagName||(i[l[0]]=l[1]))}var a="";for(var o in i)if(i.hasOwnProperty(o)){if("font-size"==o&&"pt;"==i[o].slice(-3)){var s=null;try{s=parseFloat(i[o].slice(0,-3),10)}catch(g){}s&&(s=Math.round(1.33*s),i[o]=s+"px;")}a+=o+":"+i[o]}a&&e.setAttribute("style",a)}}}(e)}return!0}),g(r,function(e){if(e&&"A"===e.nodeName&&""===e.href){for(var t=document.createDocumentFragment();e.firstChild;)t.appendChild(e.firstChild);e.parentNode.replaceChild(t,e)}return!0});var o=r.outerHTML,s=A.opts.htmlAllowedStyleProps;return A.opts.htmlAllowedStyleProps=A.opts.wordAllowedStyleProps,o=A.clean.html(o,A.opts.wordDeniedTags,A.opts.wordDeniedAttrs,!1),A.opts.htmlAllowedStyleProps=s,o}(i=i.replace(/<span[\n\r ]*style='mso-spacerun:yes'>([\r\n\u00a0 ]*)<\/span>/g,function(e,t){for(var r="",i=0;i++<t.length;)r+="&nbsp;";return r}),A.paste.getRtfClipboard());var r=A.doc.createElement("DIV");r.innerHTML=i,A.html.cleanBlankSpaces(r),i=r.innerHTML,i=(i=A.paste.cleanEmptyTagsAndDivs(i)).replace(/\u200b/g,""),A.modals.hide(a),A.paste.clean(i,!0,!0),A.opts.wordAllowedStyleProps=t}function y(e){e.parentNode&&e.parentNode.removeChild(e)}function g(e,t){if(t(e))for(var r=e.firstChild;r;){var i=r,n=r.previousSibling;r=r.nextSibling,g(i,t),i.previousSibling||i.nextSibling||i.parentNode||!r||n==r.previousSibling||!r.parentNode?i.previousSibling||i.nextSibling||i.parentNode||!r||r.previousSibling||r.nextSibling||r.parentNode||(n?r=n.nextSibling?n.nextSibling.nextSibling:null:e.firstChild&&(r=e.firstChild.nextSibling)):r=n?n.nextSibling:e.firstChild}}function C(e){if(!e.getAttribute("style")||!/mso-list:[\s]*l/gi.test(e.getAttribute("style").replace(/\n/gi,"")))return!1;try{if(!e.querySelector('[style="mso-list:Ignore"]'))return!1}catch(t){return!1}return!0}function v(e){return e.getAttribute("style").replace(/\n/gi,"").replace(/.*level([0-9]+?).*/gi,"$1")}function b(e,t){var r=e.cloneNode(!0);if(-1!=["H1","H2","H3","H4","H5","H6"].indexOf(e.tagName)){var i=document.createElement(e.tagName.toLowerCase());i.setAttribute("style",e.getAttribute("style")),i.innerHTML=r.innerHTML,r.innerHTML=i.outerHTML}g(r,function(e){return e.nodeType==Node.ELEMENT_NODE&&("mso-list:Ignore"==e.getAttribute("style")&&e.parentNode.removeChild(e),u(e,t)),!0});var n=r.innerHTML;return n.replace(/<!--[\s\S]*?-->/gi,"")}function h(e,t){for(var r=document.createElement(t),i=0;i<e.attributes.length;i++){var n=e.attributes[i].name;r.setAttribute(n,e.getAttribute(n))}return r.innerHTML=e.innerHTML,e.parentNode.replaceChild(r,e),r}function x(e){var t=e.getAttribute("align");t&&(e.style["text-align"]=t,e.removeAttribute("align"))}function N(e){return e.replace(/\n|\r|\n\r|&quot;/g,"")}function w(e,t,r){if(t){var i=e.getAttribute("style");i&&";"!=i.slice(-1)&&(i+=";"),t&&";"!=t.slice(-1)&&(t+=";"),t=t.replace(/\n/gi,"");var n=null;n=r?(i||"")+t:t+(i||""),e.setAttribute("style",n)}}function f(e,t,r){for(var i=e.split(r),n=1;n<i.length;n++){var l=i[n];if(1<(l=l.split("shplid")).length){l=l[1];for(var a="",o=0;o<l.length&&"\\"!=l[o]&&"{"!=l[o]&&" "!=l[o]&&"\r"!=l[o]&&"\n"!=l[o];)a+=l[o],o++;var s=l.split("bliptag");if(s&&s.length<2)continue;var d=null;if(-1!=s[0].indexOf("pngblip")?d="image/png":-1!=s[0].indexOf("jpegblip")&&(d="image/jpeg"),!d)continue;var g,f=s[1].split("}");if(f&&f.length<2)continue;if(2<f.length&&-1!=f[0].indexOf("blipuid"))g=f[1].split(" ");else{if((g=f[0].split(" "))&&g.length<2)continue;g.shift()}var u=g.join("");p[t+a]={image_hex:u,image_type:d}}}}function u(e,t){var r=e.tagName,i=r.toLowerCase();if(e.firstElementChild&&("I"==e.firstElementChild.tagName?h(e.firstElementChild,"em"):"B"==e.firstElementChild.tagName&&h(e.firstElementChild,"strong")),-1!=["SCRIPT","APPLET","EMBED","NOFRAMES","NOSCRIPT"].indexOf(r))return y(e),!1;var n=-1,l=["META","LINK","XML","ST1:","O:","W:","FONT"];for(n=0;n<l.length;n++)if(-1!=r.indexOf(l[n]))return e.innerHTML&&(e.outerHTML=e.innerHTML),y(e),!1;if("TD"!=r){var a=e.getAttribute("class");if(t&&a){var o=(a=N(a)).split(" ");for(n=0;n<o.length;n++){var s=[],d="."+o[n];s.push(d),d=i+d,s.push(d);for(var g=0;g<s.length;g++)t[s[g]]&&w(e,t[s[g]])}e.removeAttribute("class")}t&&t[i]&&w(e,t[i])}if(-1!=["P","H1","H2","H3","H4","H5","H6","PRE"].indexOf(r)){var f=e.getAttribute("class");if(f&&(t&&t[r.toLowerCase()+"."+f]&&w(e,t[r.toLowerCase()+"."+f]),-1!=f.toLowerCase().indexOf("mso"))){var u=N(f);(u=u.replace(/[0-9a-z-_]*mso[0-9a-z-_]*/gi,""))?e.setAttribute("class",u):e.removeAttribute("class")}var p=e.getAttribute("style");if(p){var c=p.match(/text-align:.+?[; "]{1,1}/gi);c&&c[c.length-1].replace(/(text-align:.+?[; "]{1,1})/gi,"$1")}x(e)}if("TR"==r&&function(e,t){A.node.clearAttributes(e);for(var r=e.firstElementChild,i=0,n=!1,l=null;r;){r.firstElementChild&&-1!=r.firstElementChild.tagName.indexOf("W:")&&(r.innerHTML=r.firstElementChild.innerHTML),(l=r.getAttribute("width"))||n||(n=!0),i+=parseInt(l,10),(!r.firstChild||r.firstChild&&r.firstChild.data==S.FE.UNICODE_NBSP)&&(r.firstChild&&y(r.firstChild),r.innerHTML="<br>");for(var a=r.firstElementChild,o=1==r.children.length;a;)"P"!=a.tagName||C(a)||o&&x(a),a=a.nextElementSibling;if(t){var s=r.getAttribute("class");if(s){var d=(s=N(s)).match(/xl[0-9]+/gi);if(d){var g="."+d[0];t[g]&&w(r,t[g])}}t.td&&w(r,t.td)}var f=r.getAttribute("style");f&&(f=N(f))&&";"!=f.slice(-1)&&(f+=";");var u=r.getAttribute("valign");if(!u&&f){var p=f.match(/vertical-align:.+?[; "]{1,1}/gi);p&&(u=p[p.length-1].replace(/vertical-align:(.+?)[; "]{1,1}/gi,"$1"))}var c=null;if(f){var m=f.match(/text-align:.+?[; "]{1,1}/gi);m&&(c=m[m.length-1].replace(/text-align:(.+?)[; "]{1,1}/gi,"$1")),"general"==c&&(c=null)}var h=null;if(f){var v=f.match(/background:.+?[; "]{1,1}/gi);v&&(h=v[v.length-1].replace(/background:(.+?)[; "]{1,1}/gi,"$1"))}var b=r.getAttribute("colspan"),E=r.getAttribute("rowspan");b&&r.setAttribute("colspan",b),E&&r.setAttribute("rowspan",E),u&&(r.style["vertical-align"]=u),c&&(r.style["text-align"]=c),h&&(r.style["background-color"]=h),l&&r.setAttribute("width",l),r=r.nextElementSibling}for(r=e.firstElementChild;r;)l=r.getAttribute("width"),n?r.removeAttribute("width"):r.setAttribute("width",100*parseInt(l,10)/i+"%"),r=r.nextElementSibling}(e,t),"A"!=r||e.attributes.getNamedItem("href")||e.attributes.getNamedItem("name")||!e.innerHTML||(e.outerHTML=e.innerHTML),"TD"!=r&&"TH"!=r||e.innerHTML||(e.innerHTML="<br>"),"TABLE"==r&&(e.style.width="100%"),e.getAttribute("lang")&&e.removeAttribute("lang"),e.getAttribute("style")&&-1!=e.getAttribute("style").toLowerCase().indexOf("mso")){var m=N(e.getAttribute("style"));(m=m.replace(/[0-9a-z-_]*mso[0-9a-z-_]*:.+?(;{1,1}|$)/gi,""))?e.setAttribute("style",m):e.removeAttribute("style")}return!0}var l,i,a="word_paste",p=null,c={};return{_init:function(){A.events.on("paste.wordPaste",function(e){return i=e,A.opts.wordPasteModal?function(){if(!l){var e='<h4><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 74.95 73.23" style="height: 25px; vertical-align: text-bottom; margin-right: 5px; display: inline-block"><defs><style>.a{fill:#2a5699;}.b{fill:#fff;}</style></defs><path class="a" d="M615.15,827.22h5.09V834c9.11.05,18.21-.09,27.32.05a2.93,2.93,0,0,1,3.29,3.25c.14,16.77,0,33.56.09,50.33-.09,1.72.17,3.63-.83,5.15-1.24.89-2.85.78-4.3.84-8.52,0-17,0-25.56,0v6.81h-5.32c-13-2.37-26-4.54-38.94-6.81q0-29.8,0-59.59c13.05-2.28,26.11-4.5,39.17-6.83Z" transform="translate(-575.97 -827.22)"/><path class="b" d="M620.24,836.59h28.1v54.49h-28.1v-6.81h22.14v-3.41H620.24v-4.26h22.14V873.2H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24V846h22.14v-3.41H620.24Zm-26.67,15c1.62-.09,3.24-.16,4.85-.25,1.13,5.75,2.29,11.49,3.52,17.21,1-5.91,2-11.8,3.06-17.7,1.7-.06,3.41-.15,5.1-.26-1.92,8.25-3.61,16.57-5.71,24.77-1.42.74-3.55,0-5.24.09-1.13-5.64-2.45-11.24-3.47-16.9-1,5.5-2.29,10.95-3.43,16.42q-2.45-.13-4.92-.3c-1.41-7.49-3.07-14.93-4.39-22.44l4.38-.18c.88,5.42,1.87,10.82,2.64,16.25,1.2-5.57,2.43-11.14,3.62-16.71Z" transform="translate(-575.97 -827.22)"/></svg> '+A.language.translate("Word Paste Detected")+"</h4>",t=(n='<div class="fr-word-paste-modal" style="padding: 20px 20px 10px 20px;">',n+='<p style="text-align: left;">'+A.language.translate("The pasted content is coming from a Microsoft Word document. Do you want to keep the format or clean it up?")+"</p>",n+='<div style="text-align: right; margin-top: 50px;"><button class="fr-remove-word fr-command">'+A.language.translate("Clean")+'</button> <button class="fr-keep-word fr-command">'+A.language.translate("Keep")+"</button></div>",n+="</div>"),r=A.modals.create(a,e,t),i=r.$body;l=r.$modal,r.$modal.addClass("fr-middle"),A.events.bindClick(i,"button.fr-remove-word",function(){(l.data("instance")||A).wordPaste.clean()}),A.events.bindClick(i,"button.fr-keep-word",function(){(l.data("instance")||A).wordPaste.clean(!0)}),A.events.$on(S(A.o_win),"resize",function(){A.modals.resize(a)})}var n;A.modals.show(a),A.modals.resize(a)}():t(A.opts.wordPasteKeepFormatting),!1})},clean:t}}});